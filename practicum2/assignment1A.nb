(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12575,        365]
NotebookOptionsPosition[     11633,        328]
NotebookOutlinePosition[     11991,        344]
CellTagsIndexPosition[     11948,        341]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Geometric Algorithms: Practicum 2A\n",
 StyleBox["Line-Segment Intersection", "Chapter"]
}], "Title",
 CellChangeTimes->{{3.6203131433613653`*^9, 3.6203132031789637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Init", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"r", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"r00", ",", " ", "r01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"p00", ",", " ", "p01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"q00", ",", " ", "q01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"s00", ",", " ", "s01"}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Check", " ", "of", " ", "de", " ", "lijnen", " ", "q"}], " ", 
     "\[Rule]", " ", 
     RowBox[{
      RowBox[{"s", " ", "en", " ", "p"}], " ", "\[Rule]", " ", 
      RowBox[{"r", " ", "parallell", " ", "zijn"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"r000", ",", " ", "r001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"s000", ",", "s001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"q000", ",", "q001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"p000", ",", "p001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Solving", " ", "for", " ", "t"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rCrossS", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{"rExtended", ",", " ", "sExtended"}], "]"}], ",", " ", "3"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tTeller", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"qExtended", " ", "-", " ", "pExtended"}], ")"}], ",", " ", 
         "sExtended"}], "]"}], ",", " ", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"*", " ", "Solving", " ", "for", " ", "u"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uTeller", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"qExtended", " ", "-", " ", "pExtended"}], ")"}], ",", " ", 
         "rExtended"}], "]"}], ",", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Overlapping", " ", "case", " ", "1"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"overlapTest1", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"qExtended", " ", "-", " ", "pExtended"}], ")"}], ",", " ", 
         "rExtended"}], "]"}], ",", " ", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"overlapTest2", " ", "=", " ", 
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pExtended", " ", "-", " ", "qExtended"}], ")"}], ",", " ", 
         "sExtended"}], "]"}], ",", " ", "3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.620313197729998*^9, 3.620313380862606*^9}, {
   3.620313505433661*^9, 3.620313526759863*^9}, {3.6203135913351707`*^9, 
   3.620313596157991*^9}, {3.620313666853066*^9, 3.620313724534268*^9}, {
   3.6203138120738697`*^9, 3.620313884528373*^9}, {3.620314024366362*^9, 
   3.620314025895422*^9}, {3.6203144597760067`*^9, 3.620314504184415*^9}, {
   3.620314538084062*^9, 3.620314603269182*^9}, {3.620314667159618*^9, 
   3.6203147385581713`*^9}, {3.620314776947686*^9, 3.620314793879589*^9}, {
   3.620315366194992*^9, 3.620315426236065*^9}, {3.620315791381667*^9, 
   3.62031579898948*^9}, {3.620486024472129*^9, 3.620486024696314*^9}, 
   3.62048688618985*^9, {3.620486922723905*^9, 3.620486922842101*^9}}],

Cell[BoxData[
 StyleBox[
  RowBox[{"Half", " ", "Plane"}], "Chapter"]], "Input",
 CellChangeTimes->{{3.620566889750946*^9, 3.620566892904665*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"planeDotV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"planeDot10", ",", " ", "planeDot11", ",", " ", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"planeMin", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"planeDot00", ",", " ", "planeDot01", ",", " ", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"planeDot", " ", "=", " ", 
   RowBox[{"planeDotV", " ", "-", " ", "planeMin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x0", ",", " ", "x1", ",", " ", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CForm", "[", 
  RowBox[{"Part", "[", 
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{"planeDot", ",", " ", 
      RowBox[{"(", 
       RowBox[{"x", " ", "-", " ", "planeMin"}], " ", ")"}]}], "]"}], " ", 
    ",", "3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.620566895456633*^9, 3.62056698090204*^9}, {
  3.620567019492465*^9, 3.6205670495563707`*^9}, {3.620567115394462*^9, 
  3.620567175679261*^9}, {3.620570030796636*^9, 3.620570058713509*^9}}],

Cell["\<\
-(planeDot01*planeDot10) + planeDot00*planeDot11 + planeDot01*x0 - \
planeDot11*x0 - 
   planeDot00*x1 + planeDot10*x1\
\>", "Output",
 CellChangeTimes->{3.620567176178411*^9, 3.6205700603933268`*^9}]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Point", " ", "in", " ", "Polygon"}], "Chapter"]], "Input",
 CellChangeTimes->{{3.620575270819148*^9, 3.6205752809393587`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Init", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Check", " ", "of", " ", "de", " ", "lijnen", " ", "q"}], " ", 
     "\[Rule]", " ", 
     RowBox[{
      RowBox[{"s", " ", "en", " ", "p"}], " ", "\[Rule]", " ", 
      RowBox[{"r", " ", "parallell", " ", "zijn"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"r000", ",", " ", "r001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "q000"}], ",", 
       RowBox[{"-", "q001"}], ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"qExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"q000", ",", "q001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pExtended", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"p000", ",", " ", "p001", ",", " ", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"denominator", " ", "=", " ", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"rExtended", ",", " ", "sExtended"}], "]"}], ",", "3"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"tNumerator", " ", "=", " ", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"qExtended", " ", "-", " ", "pExtended"}], ")"}], ",", " ", 
        "sExtended"}], "]"}], ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"uNumerator", " ", "=", " ", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"qExtended", " ", "-", " ", "pExtended"}], ")"}], ",", " ", 
        "rExtended"}], "]"}], ",", "3"}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.62057529192241*^9, 3.620575302097085*^9}, {
   3.620575413095201*^9, 3.620575413990048*^9}, {3.620575543596388*^9, 
   3.620575593346751*^9}, {3.620575641143921*^9, 3.620575695631968*^9}, {
   3.620576048372943*^9, 3.620576074947926*^9}, {3.620576843355157*^9, 
   3.620576864918209*^9}, 3.6205769147145348`*^9, {3.620577821892302*^9, 
   3.620577832477335*^9}, {3.620578728051484*^9, 3.6205787568927383`*^9}, {
   3.62057975305536*^9, 3.620579753779005*^9}, {3.620580486954871*^9, 
   3.620580491898403*^9}, {3.62058069937272*^9, 3.620580712404368*^9}, {
   3.6205819870835247`*^9, 3.620582049894891*^9}, {3.620582085734293*^9, 
   3.620582121117125*^9}, {3.6205821967001038`*^9, 3.6205822224111757`*^9}, 
   3.6205822660109663`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "q001"}], " ", "r000"}], "+", 
  RowBox[{"q000", " ", "r001"}]}]], "Output",
 CellChangeTimes->{3.620582050985268*^9, 3.6205821220898523`*^9, 
  3.620582222787262*^9, 3.620582266446149*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "p001"}], " ", "q000"}], "+", 
  RowBox[{"p000", " ", "q001"}]}]], "Output",
 CellChangeTimes->{3.620582050985268*^9, 3.6205821220898523`*^9, 
  3.620582222787262*^9, 3.620582266449732*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p001", " ", "r000"}], "-", 
  RowBox[{"q001", " ", "r000"}], "-", 
  RowBox[{"p000", " ", "r001"}], "+", 
  RowBox[{"q000", " ", "r001"}]}]], "Output",
 CellChangeTimes->{3.620582050985268*^9, 3.6205821220898523`*^9, 
  3.620582222787262*^9, 3.62058226645243*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "uNumerator", "]"}]], "Input",
 CellChangeTimes->{{3.620580786722288*^9, 3.620580807545432*^9}, {
  3.620580852068535*^9, 3.620580852215769*^9}, {3.620582054240943*^9, 
  3.620582054989242*^9}, {3.620582124625643*^9, 3.6205821256448402`*^9}, {
  3.620582226223194*^9, 3.62058222658674*^9}}],

Cell["p001*r000 - q001*r000 - p000*r001 + q000*r001", "Output",
 CellChangeTimes->{3.620582055519219*^9, 3.6205821259584503`*^9, 
  3.6205822269241*^9, 3.620582269537809*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross[{v1, v2, 0}, {w1, w2, 0}]", "Input",
 CellChangeTimes->{{3.6205820531100483`*^9, 3.620582053112199*^9}, {
  3.620584196117017*^9, 3.620584208906645*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "v2"}], " ", "w1"}], "+", 
    RowBox[{"v1", " ", "w2"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.620584209342844*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{840, 1006},
WindowMargins->{{Automatic, 91}, {Automatic, -1050}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 189, 4, 136, "Title"],
Cell[772, 28, 4474, 116, 386, "Input"],
Cell[5249, 146, 146, 3, 57, "Input"],
Cell[CellGroupData[{
Cell[5420, 153, 1125, 30, 97, "Input"],
Cell[6548, 185, 210, 5, 44, "Output"]
}, Open  ]],
Cell[6773, 193, 162, 3, 57, "Input"],
Cell[CellGroupData[{
Cell[6960, 200, 2888, 69, 250, "Input"],
Cell[9851, 271, 240, 6, 28, "Output"],
Cell[10094, 279, 240, 6, 28, "Output"],
Cell[10337, 287, 298, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10672, 299, 327, 5, 28, "Input"],
Cell[11002, 306, 174, 2, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11213, 313, 165, 2, 29, InheritFromParent],
Cell[11381, 317, 224, 7, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
